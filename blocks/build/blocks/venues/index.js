(()=>{"use strict";const e=window.wp.blocks,t=window.React,n=window.wp.i18n,l=window.wp.blockEditor,s=window.wp.components,a=window.wp.element,r=window.wp.data,c=window.wp.coreData,i=window.wp.htmlEntities,d=JSON.parse('{"UU":"wpgens/venues"}');(0,e.registerBlockType)(d.UU,{edit:function({attributes:e,setAttributes:d}){const o=(0,l.useBlockProps)(),{selectedVenues:m=[],title:p="Popular Venues",subtitle:u=""}=e,[g,w]=(0,a.useState)(!0),[x,h]=(0,a.useState)(""),[E,b]=(0,a.useState)([]),[f,v]=(0,a.useState)([]),{venues:_,allVenues:y}=(0,r.useSelect)((e=>{let t=[];if(m.length>0){const n=e(c.store).getEntityRecords("postType","places",{include:m,per_page:m.length,_embed:!0});n&&(t=n)}const n={per_page:100,status:"publish",orderby:"title",order:"asc"};return x&&(n.search=x),{venues:t,allVenues:e(c.store).getEntityRecords("postType","places",n)||[]}}),[m,x]);return(0,a.useEffect)((()=>{if(y&&y.length>0){const e=y.filter((e=>!m.includes(e.id.toString()))).map((e=>({id:e.id.toString(),name:(0,i.decodeEntities)(e.title.rendered)})));b(e),w(!1)}else y&&(b([]),w(!1))}),[y,m]),(0,a.useEffect)((()=>{if(_){const e=_.map((e=>(0,i.decodeEntities)(e.title.rendered)));v(e)}}),[_]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.InspectorControls,null,(0,t.createElement)(s.PanelBody,{title:(0,n.__)("Venues Settings","wpgens-blocks")},(0,t.createElement)(s.TextControl,{label:(0,n.__)("Section Title","wpgens-blocks"),value:p,onChange:e=>d({title:e})}),(0,t.createElement)(s.TextControl,{label:(0,n.__)("Section Subtitle","wpgens-blocks"),value:u,onChange:e=>d({subtitle:e})}),(0,t.createElement)(s.FormTokenField,{label:(0,n.__)("Search and Select Venues","wpgens-blocks"),value:f,suggestions:E.map((e=>e.name)),onChange:e=>{const t=f.filter((t=>!e.includes(t)));if(t.length>0){const e=t[0],n=_.find((t=>(0,i.decodeEntities)(t.title.rendered)===e));if(n){const e=m.filter((e=>e!==n.id.toString()));d({selectedVenues:e})}}else if(e.length>f.length){const t=e.find((e=>!f.includes(e))),n=E.find((e=>e.name===t));n&&d({selectedVenues:[...m,n.id]})}},onInputChange:e=>{h(e),w(!0)},maxSuggestions:10,placeholder:(0,n.__)("Type to search venues...","wpgens-blocks")}),g&&(0,t.createElement)("div",{style:{textAlign:"center",padding:"10px"}},(0,t.createElement)(s.Spinner,null)))),(0,t.createElement)("div",{...o},(0,t.createElement)("section",{className:"max-w-screen-2xl px-4 md:px-8 2xl:px-0 my-16 md:my-32 mx-auto relative"},(0,t.createElement)("div",{className:"text-center mb-6 md:mb-12"},(0,t.createElement)("h2",{className:"text-3xl md:text-4xl lg:text-5xl text-white uppercase font-light mb-2 leading-none"},p),u&&(0,t.createElement)("p",{className:"uppercase md:tracking-[3px] text-primary-dark"},u)),(0,t.createElement)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-x-4 md:gap-x-6 gap-y-6 md:gap-y-12"},g&&!_?.length?(0,t.createElement)("div",{className:"col-span-2 md:col-span-5 text-center py-8"},(0,t.createElement)(s.Spinner,null),(0,n.__)("Loading venues...","wpgens-blocks")):_&&_.length>0?_.map((e=>{const n=(0,i.decodeEntities)(e.title.rendered),l=(e=>e._embedded&&e._embedded["wp:featuredmedia"]&&e._embedded["wp:featuredmedia"][0]&&e._embedded["wp:featuredmedia"][0].source_url?e._embedded["wp:featuredmedia"][0].source_url:"")(e),s=e.meta?.city||"",a=e.meta?.state||"";return(0,t.createElement)("a",{key:e.id,href:"#",className:"relative group flex flex-col w-full uppercase overflow-hidden"},(0,t.createElement)("div",{className:"h-48 overflow-hidden"},(0,t.createElement)("img",{src:l||"/wp-content/themes/bottleservices/assets/images/artist-placeholder.jpeg",className:"h-48 object-cover w-full group-hover:scale-110 transition-all",alt:n})),(0,t.createElement)("span",{className:"text-secondary tracking-[1px] text-xs leading-none py-3"},s&&a?`${s}, ${a}`:""),(0,t.createElement)("h2",{className:"text-white text-sm md:text-lg font-medium tracking-[1.5px] leading-none group-hover:text-primary"},n))})):(0,t.createElement)("div",{className:"col-span-2 md:col-span-5 text-center py-8 text-white"},(0,n.__)("Add venues using the sidebar controls","wpgens-blocks"))))))},save:function(){return(0,t.createElement)("div",{...l.useBlockProps.save()})}})})();